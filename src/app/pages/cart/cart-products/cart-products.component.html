<div class="cart-items bg-white ">
    @for (item of cartItems; track item.product_id + '-' + item.product_variant_id; let
    i = $index) {

    <div class="cart-item p-3 border-bottom">

        <div class="d-flex align-items-center justify-content-between">
            <!-- Product Image -->
            <div class="col-img cursor-pointer" (click)="openProduct(item.product!)">
                <div class="product-image">
                    <img [src]="getPrimaryImage(item.product!)" [alt]="item.product?.name" class="img-fluid rounded">
                </div>
            </div>

            <!-- Product Info -->
            <div class="flex-grow-1 px-3 cursor-pointer" (click)="openProduct(item.product!)">
                <div class="d-flex flex-column flex-sm-row align-items-start align-items-sm-center gap-0">
                    <span class="fw-bold me-2">{{ item.product?.name }}</span>
                    <div class="d-flex align-items-center gap-2">
                        <span class="small d-none d-sm-inline">Farba:</span>
                        <div class="color-indicator d-flex align-items-center gap-1">
                            <div class="color-box-mini" [ngClass]="'color-box-' + item.variant?.color">
                            </div>
                            <span class="small">{{ getColorDisplayName(item.variant?.color!) }}</span>
                        </div>
                    </div>
                </div>
                <p class="text-muted small mb-1 product-description">{{
                    item.product?.description
                    }}</p>
            </div>

            <!-- Quantity Controls -->
            <div class="col-controls">
                <div class="quantity-controls d-flex align-items-center justify-content-center">
                    <button class="btn btn-outline-secondary btn-sm quantity-btn"
                        (click)="updateQuantity(item, item.quantity - 1)">
                        <span class="material-symbols-outlined">remove</span>
                    </button>
                    <span class="quantity-display mx-2 fw-bold">{{ item.quantity }}
                        ks</span>
                    <button class="btn btn-outline-secondary btn-sm quantity-btn"
                        (click)="updateQuantity(item, item.quantity + 1)">
                        <span class="material-symbols-outlined">add</span>
                    </button>
                </div>
            </div>

            <!-- Price & Remove -->
            <div class="col-price text-end">
                <div class="price-section">
                    <p class="fw-bold fs-6 mb-1 ">{{ item.totalPrice |
                        sbPrice }}</p>
                </div>
            </div>
        </div>
    </div>
    }

    <div>
        <div class="cart-summary text-end p-3">
            <div class="text-muted small">
                <span>Počet položiek: {{ cartItems?.length }}</span>
            </div>
            <div class="mb-2">
                <span class="fw-bold me-3">Spolu:</span>
                <span class="text-accent fw-bold fs-5">{{ cartTotals.totalPrice | sbPrice }}</span>
            </div>

        </div>
    </div>
</div>